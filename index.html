<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRISM: High-Resolution & Precise Counterfactual Medical Image Generation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="./styles.css">
</head>
<body>
    <div class="top-bar">
        <div class="container">
            <div class="nav-links">
                <a href="#abstract">Abstract</a>
                <a href="#synthesized-images">Synthesized Images</a>
                <a href="#method">Method</a>
                <a href="#results">Results</a>
                <a href="#citation">Citation</a>
            </div>
        </div>
    </div>
    
    <header>
        <div class="container">
            <h1>PRISM: High-Resolution & Precise Counterfactual Medical Image Generation</h1>
            <p class="subtitle">Using Language-guided Stable Diffusion</p>
            
            <div class="authors">
                <span class="author-name"><a href="https://www.cim.mcgill.ca/~amarkr/" target="_blank">Amar Kumar</a><sup>1,2</sup></span>
                <span class="author-name"><a href="https://www.cim.mcgill.ca/~anitakriz/" target="_blank">Anita Kriz</a><sup>1,2</sup></span>
                <span class="author-name"><a href="https://havaeimo.github.io/about" target="_blank">Mohammad Havaei</a><sup>3</sup></span>
                <span class="author-name"><a href="https://www.cim.mcgill.ca/~arbel/#" target="_blank">Tal Arbel</a><sup>1,2</sup></span>
            </div>
            
            <div class="affiliations">
                <span class="affiliation"><sup>1</sup>McGill University, Montreal, Canada</span>
                <span class="affiliation"><sup>2</sup>MILA (Quebec AI Institute), Montreal, Canada</span>
                <span class="affiliation"><sup>3</sup>Google Research, Montreal, Canada</span>
            </div>
            
            <div class="links-section">
                <a href="https://arxiv.org/pdf/2503.00196v1" class="link-button" target="_blank"><i class="fas fa-file-pdf"></i> Paper</a>
                <a href="https://github.com/Amarkr1/PRISM" class="link-button" target="_blank"><i class="fab fa-github"></i> Code</a>
                <a href="#" class="link-button"><i class="fas fa-play-circle"></i> Demo</a>
                <a href="https://stanfordmlgroup.github.io/competitions/chexpert/" class="link-button" target="_blank"><i class="fas fa-database"></i> Dataset</a>
                <a href="#" class="link-button"><i class="fas fa-video"></i> Video</a>
            </div>
        </div>
    </header>
    
    <main class="container">
        
        <div class="abstract-section" id="abstract">
            <h2>Abstract</h2>
            <p>
                Developing reliable and generalizable deep learning systems for medical imaging faces significant obstacles due to spurious correlations, data imbalances, and limited text annotations in datasets. Addressing these challenges requires architectures robust to the unique complexities posed by medical imaging data. The rapid advancements in vision-language foundation models within the natural image domain prompt the question of how they can be adapted for medical imaging tasks. In this work, we present PRISM, a framework that leverages foundation models to generate high-resolution, language-guided medical image counterfactuals using Stable Diffusion. Our approach demonstrates unprecedented precision in selectively modifying spurious correlations (the medical devices) and disease features, enabling the removal and addition of specific attributes while preserving other image characteristics. Through extensive evaluation, we show how PRISM advances counterfactual generation and enables the development of more robust downstream classifiers for clinically deployable solutions. To facilitate broader adoption and research, we make our code publicly available at https://github.com/Amarkr1/PRISM.
            </p>
        </div>

        <!-- New Synthesized Images Section -->
        <h2 id="synthesized-images">Synthesized Images</h2>
        <p>
            PRISM can generate high-fidelity counterfactual medical images with precise control over specific attributes. Below we showcase a variety of examples demonstrating our model's capability to sythesize text given a text prompt.
        </p>
        
        <!-- Image Gallery with Right-to-Left Display -->
        <div class="image-gallery-section">
            
            
            <div class="image-gallery" id="image-gallery">
                <div class="gallery-item">
                    <img src="images/image1.png" alt="Chest X-ray with pneumothorax" class="gallery-image">
                    <div class="gallery-title">Cardiomegaly</div>
                    <div class="gallery-caption">Chest x-ray of a patient with severe cardiomegaly and lots of support devices</div>
                </div>
                <div class="gallery-item">
                    <img src="images/image2.png" alt="Chest X-ray with pleural effusion" class="gallery-image">
                    <div class="gallery-title">Healthy</div>
                    <div class="gallery-caption">Chest x-ray of a patient with no findings</div>
                </div>
                <div class="gallery-item">
                    <img src="images/image3.png" alt="Chest X-ray with removed support device" class="gallery-image">
                    <div class="gallery-title">Healthy</div>
                    <div class="gallery-caption">Chest x-ray of a patient with no findings and support devices</div>
                </div>
                <div class="gallery-item">
                    <img src="images/image4.png" alt="Chest X-ray with added cardiomegaly" class="gallery-image">
                    <div class="gallery-title">Cardiomegaly</div>
                    <div class="gallery-caption">Chest x-ray of a patient with cardiomegaly and no devices</div>
                </div>
                <div class="gallery-item">
                    <img src="images/image5.png" alt="Normal chest X-ray" class="gallery-image">
                    <div class="gallery-title">Cardiomegaly & Pleural Effusion</div>
                    <div class="gallery-caption">Chest x-ray of a patient with cardiomegaly and pleural effusion</div>
                </div>
                <div class="gallery-item">
                    <img src="images/image6.png" alt="Normal chest X-ray" class="gallery-image">
                    <div class="gallery-title">Pleural Effusion</div>
                    <div class="gallery-caption">Chest x-ray of a patient with pleural effusion</div>
                </div>
                <div class="gallery-item">
                    <img src="images/image7.png" alt="Normal chest X-ray" class="gallery-image">
                    <div class="gallery-title">Pleural Effusion</div>
                    <div class="gallery-caption">Chest x-ray of a patient with pleural effusion and support devices</div>
                </div>
            </div>
            <div class="gallery-controls">
                <button class="gallery-control" id="scroll-right"><i class="fas fa-chevron-left"></i></button>
                <button class="gallery-control" id="scroll-left"><i class="fas fa-chevron-right"></i></button>
            </div>
        </div>
        
        
        
        <h2>Overview</h2>
        <p>
            -
        </p>
        
        <div class="highlight-box">
            <h3>Key Contributions</h3>
            <ul>
                <li>A novel pipeline for generating high-fidelity counterfactual medical images with unprecedented resolution and precision</li>
                <li>A specialized language-guided stable diffusion model fine-tuned on diverse medical imaging datasets</li>
                <li>A comprehensive evaluation framework for assessing the clinical accuracy and utility of generated counterfactual images</li>
            </ul>
        </div>
        
        <div class="figure-container">
            <img src="images/arch_v2.png" alt="PRISM pipeline" class="figure-image">
            <div class="figure-caption">
                <strong>Figure 2:</strong> Overview of the PRISM pipeline. Given an input medical image and a text description of the desired edit, our model generates a counterfactual image that implements the requested changes while preserving patient-specific anatomical details.
            </div>
        </div>
        

        <h2 id="results">Results</h2>
        <div class="results">
            <div class="figure-container">
                <div class="gif-container" style="display: flex; justify-content: center; gap: 30px; flex-wrap: wrap;">
                    <div class="gif-item" style="flex: 1; min-width: 300px; max-width: 450px;">
                        <img src="./images/animation5.gif" alt="PRISM results visualization - pathology addition" class="figure-image gif-image" style="width: 100%; height: auto;">
                        <div class="gif-title" style="text-align: center; font-weight: 600; color: var(--primary-color); margin-top: 10px; margin-bottom: 5px;">
                            Devices --> No Devices
                        </div>
                        <div class="gif-controls" style="display: flex; justify-content: center; margin-top: 10px;">
                            <button class="toggle-play-btn" data-status="playing" title="Pause/Play Animation" style="position: static; margin: 0 auto;">
                                <i class="fas fa-pause"></i> Pause Animation
                            </button>
                        </div>
                    </div>
                    <div class="gif-item" style="flex: 1; min-width: 300px; max-width: 450px;">
                        <img src="./images/animation4.gif" alt="PRISM results visualization - device removal" class="figure-image gif-image" style="width: 100%; height: auto;">
                        <div class="gif-title" style="text-align: center; font-weight: 600; color: var(--primary-color); margin-top: 10px; margin-bottom: 5px;">
                            Pleural Effusion --> Healthy
                        </div>
                        <div class="gif-controls" style="display: flex; justify-content: center; margin-top: 10px;">
                            <button class="toggle-play-btn" data-status="playing" title="Pause/Play Animation" style="position: static; margin: 0 auto;">
                                <i class="fas fa-pause"></i>
                            </button>
                        </div>
                    </div>
                    <div class="gif-item" style="flex: 1; min-width: 300px; max-width: 450px;">
                        <img src="./images/results.gif" alt="PRISM results visualization - device removal" class="figure-image gif-image" style="width: 100%; height: auto;">
                        <div class="gif-title" style="text-align: center; font-weight: 600; color: var(--primary-color); margin-top: 10px; margin-bottom: 5px;">
                            Cardiomegaly --> Healthy
                        </div>
                        <div class="gif-controls" style="display: flex; justify-content: center; margin-top: 10px;">
                            <button class="toggle-play-btn" data-status="playing" title="Pause/Play Animation" style="position: static; margin: 0 auto;">
                                <i class="fas fa-pause"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="figure-caption">
                    <strong>Figure 3:</strong> Demonstration of PRISM's ability to perform precise counterfactual edits on chest X-rays. The GIFs show the progression from original images to counterfactual variants with specific pathologies added or removed while preserving anatomical integrity. <em>Use the pause/play buttons to control the animations.</em>
                </div>
            </div>
            <p>
                Our extensive evaluation demonstrates PRISM's ability to generate high-quality counterfactual medical images with unprecedented precision. The model successfully preserves patient-specific anatomical details while selectively modifying targeted disease features or removing spurious correlations as directed by language prompts.
            </p>
        </div>
        
        
                
        <h2 id="citation">Citation</h2>
        <div class="citation">
@article{kumar2025prism,
title={PRISM: High-Resolution \& Precise Counterfactual Medical Image Generation using Language-guided Stable Diffusion},
author={Kumar, Amar and Kriz, Anita and Havaei, Mohammad and Arbel, Tal},
year={2025}
}
        </div>
        
        <h2>Acknowledgements</h2>
        <p>
            The authors are grateful for funding provided by the Natural Sciences and Engineering Research Council of Canada, the Canadian Institute for Advanced Research (CIFAR) Artificial Intelligence Chairs program, Mila - Quebec AI Institute, Google Research, Calcul Quebec, Fonds de recherche du Québec (FRQNT),  and the Digital Research Alliance of Canada.
        </p>

             

    </main>
    
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-links">
                    <a href="#">Home</a>
                    <a href="#">Research</a>
                    <a href="#">Publications</a>
                    <a href="#">Team</a>
                    <a href="mailto:amar.kumar@mail.mcgill.ca">Contact</a>
                </div>
                <p class="copyright">© 2025 PRISM Research Team | McGill University | Probabilistic Vision Group</p>
                <div class="visitor-counter">
                    <span id="visitor-count">0</span> visitors to this page
                </div>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
</body>
</html>